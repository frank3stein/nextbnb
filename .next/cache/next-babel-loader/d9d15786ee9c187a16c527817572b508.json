{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n// import Houses from \"../houses.json\";\nimport axios from \"axios\";\nimport fetch from \"isomorphic-unfetch\";\nimport Head from \"next/head\";\nimport Layout from \"../../components/Layout\";\nimport DateRangePicker from \"../../components/DateRangePicker\";\nimport calculateNights from \"../../utils/calculate-nights.js\";\nimport { useState } from \"react\";\nimport { useStoreActions, useStoreState } from \"easy-peasy\";\n\nvar House = function House(_ref) {\n  var house = _ref.house;\n  var user = useStoreState(function (state) {\n    return state.user.user;\n  });\n  var setShowLoginModal = useStoreActions(function (actions) {\n    return actions.modals.setShowLoginModal;\n  });\n\n  var _useState = useState(false),\n      dateChosen = _useState[0],\n      setDateChosen = _useState[1];\n\n  var _useState2 = useState(0),\n      stayNights = _useState2[0],\n      setStayNights = _useState2[1];\n\n  var _useState3 = useState(),\n      startDate = _useState3[0],\n      setStartDate = _useState3[1];\n\n  var _useState4 = useState(),\n      endDate = _useState4[0],\n      setEndDate = _useState4[1];\n\n  var content = __jsx(\"div\", {\n    className: \"jsx-2306727923\" + \" \" + \"container\"\n  }, __jsx(Head, null, __jsx(\"title\", {\n    className: \"jsx-2306727923\"\n  }, house.title)), __jsx(\"article\", {\n    className: \"jsx-2306727923\"\n  }, __jsx(\"img\", {\n    src: house.picture,\n    width: \"100%\",\n    alt: \"House picture\",\n    className: \"jsx-2306727923\"\n  }), __jsx(\"p\", {\n    className: \"jsx-2306727923\"\n  }, house.type, \" - \", house.town), __jsx(\"p\", {\n    className: \"jsx-2306727923\"\n  }, house.title)), __jsx(\"aside\", {\n    className: \"jsx-2306727923\"\n  }, __jsx(\"h2\", {\n    className: \"jsx-2306727923\"\n  }, \"Add dates for prices.\"), __jsx(DateRangePicker, {\n    datesChanged: function datesChanged(startDate, endDate) {\n      setDateChosen(true);\n      setStayNights(calculateNights(startDate, endDate));\n      console.log(startDate, endDate);\n      setStartDate(startDate);\n      setEndDate(endDate);\n    }\n  }), dateChosen && __jsx(\"div\", {\n    className: \"jsx-2306727923\"\n  }, __jsx(\"h2\", {\n    className: \"jsx-2306727923\"\n  }, \"Price per night\"), __jsx(\"p\", {\n    className: \"jsx-2306727923\"\n  }, \"$\", house.price), __jsx(\"h2\", {\n    className: \"jsx-2306727923\"\n  }, \"Total price for the booking\"), __jsx(\"p\", {\n    className: \"jsx-2306727923\"\n  }, \"$\", (stayNights * house.price).toFixed(2)), user ? __jsx(\"button\", {\n    onClick: function _callee() {\n      var response;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(axios.post(\"/api/houses/reserve\", {\n                houseId: house.id,\n                startDate: startDate,\n                endDate: endDate\n              }));\n\n            case 3:\n              response = _context.sent;\n\n              if (!(response.data.status === \"error\")) {\n                _context.next = 7;\n                break;\n              }\n\n              alert(response.data.message);\n              return _context.abrupt(\"return\");\n\n            case 7:\n              _context.next = 13;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n              return _context.abrupt(\"return\");\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 9]]);\n    },\n    className: \"jsx-2306727923\" + \" \" + \"reserve\"\n  }, \"Reserve\") : __jsx(\"button\", {\n    onClick: function onClick() {\n      setShowLoginModal();\n    },\n    className: \"jsx-2306727923\" + \" \" + \"reserve\"\n  }, \"Log in to Reserve\")) || __jsx(\"p\", {\n    className: \"jsx-2306727923\"\n  }, \"Please select dates\")), house.reviewsCount ? __jsx(\"div\", {\n    className: \"jsx-2306727923\" + \" \" + \"reviews\"\n  }, __jsx(\"h3\", {\n    className: \"jsx-2306727923\"\n  }, house.reviewsCount, \" Reviews\"), house.reviews.map(function (review, index) {\n    return __jsx(\"div\", {\n      key: index,\n      className: \"jsx-2306727923\"\n    }, __jsx(\"p\", {\n      className: \"jsx-2306727923\"\n    }, new Date(review.createdAt).toDateString()), __jsx(\"p\", {\n      className: \"jsx-2306727923\"\n    }, review.comment));\n  })) : __jsx(React.Fragment, null), __jsx(_JSXStyle, {\n    id: \"2306727923\"\n  }, \".container.jsx-2306727923{display:grid;grid-template-columns:60% 40%;grid-gap:30px;}aside.jsx-2306727923{border:1px solid #ccc;padding:20px;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2VtaWwvZGV2ZWxvcG1lbnQvbmV4dGJuYi9wYWdlcy9Ib3VzZXMvW2lkXS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF1R2tCLEFBR3dCLEFBTVMsYUFMUSxTQU1qQixhQUNmLFFBTmdCLGNBQ2hCIiwiZmlsZSI6Ii9ob21lL2VtaWwvZGV2ZWxvcG1lbnQvbmV4dGJuYi9wYWdlcy9Ib3VzZXMvW2lkXS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBIb3VzZXMgZnJvbSBcIi4uL2hvdXNlcy5qc29uXCI7XG5pbXBvcnQgYXhpb3MgZnJvbSBcImF4aW9zXCI7XG5pbXBvcnQgZmV0Y2ggZnJvbSBcImlzb21vcnBoaWMtdW5mZXRjaFwiO1xuaW1wb3J0IEhlYWQgZnJvbSBcIm5leHQvaGVhZFwiO1xuaW1wb3J0IExheW91dCBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9MYXlvdXRcIjtcbmltcG9ydCBEYXRlUmFuZ2VQaWNrZXIgZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvRGF0ZVJhbmdlUGlja2VyXCI7XG5pbXBvcnQgY2FsY3VsYXRlTmlnaHRzIGZyb20gXCIuLi8uLi91dGlscy9jYWxjdWxhdGUtbmlnaHRzLmpzXCI7XG5pbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgdXNlU3RvcmVBY3Rpb25zLCB1c2VTdG9yZVN0YXRlIH0gZnJvbSBcImVhc3ktcGVhc3lcIjtcblxuY29uc3QgSG91c2UgPSAoeyBob3VzZSB9KSA9PiB7XG4gIGNvbnN0IHVzZXIgPSB1c2VTdG9yZVN0YXRlKHN0YXRlID0+IHN0YXRlLnVzZXIudXNlcik7XG4gIGNvbnN0IHNldFNob3dMb2dpbk1vZGFsID0gdXNlU3RvcmVBY3Rpb25zKFxuICAgIGFjdGlvbnMgPT4gYWN0aW9ucy5tb2RhbHMuc2V0U2hvd0xvZ2luTW9kYWxcbiAgKTtcbiAgY29uc3QgW2RhdGVDaG9zZW4sIHNldERhdGVDaG9zZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc3RheU5pZ2h0cywgc2V0U3RheU5pZ2h0c10gPSB1c2VTdGF0ZSgwKTtcbiAgY29uc3QgW3N0YXJ0RGF0ZSwgc2V0U3RhcnREYXRlXSA9IHVzZVN0YXRlKCk7XG4gIGNvbnN0IFtlbmREYXRlLCBzZXRFbmREYXRlXSA9IHVzZVN0YXRlKCk7XG4gIGNvbnN0IGNvbnRlbnQgPSAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJjb250YWluZXJcIj5cbiAgICAgIDxIZWFkPlxuICAgICAgICA8dGl0bGU+e2hvdXNlLnRpdGxlfTwvdGl0bGU+XG4gICAgICA8L0hlYWQ+XG4gICAgICA8YXJ0aWNsZT5cbiAgICAgICAgPGltZyBzcmM9e2hvdXNlLnBpY3R1cmV9IHdpZHRoPVwiMTAwJVwiIGFsdD1cIkhvdXNlIHBpY3R1cmVcIiAvPlxuICAgICAgICA8cD5cbiAgICAgICAgICB7aG91c2UudHlwZX0gLSB7aG91c2UudG93bn1cbiAgICAgICAgPC9wPlxuICAgICAgICA8cD57aG91c2UudGl0bGV9PC9wPlxuICAgICAgICB7LyogPHA+XG4gICAgICAgICAge2hvdXNlLnJhdGluZ30gKHtob3VzZS5yZXZpZXdzQ291bnR9KVxuICAgICAgICA8L3A+IC8vIHJlbW92ZWQqL31cbiAgICAgIDwvYXJ0aWNsZT5cbiAgICAgIDxhc2lkZT5cbiAgICAgICAgPGgyPkFkZCBkYXRlcyBmb3IgcHJpY2VzLjwvaDI+XG4gICAgICAgIDxEYXRlUmFuZ2VQaWNrZXJcbiAgICAgICAgICBkYXRlc0NoYW5nZWQ9eyhzdGFydERhdGUsIGVuZERhdGUpID0+IHtcbiAgICAgICAgICAgIHNldERhdGVDaG9zZW4odHJ1ZSk7XG4gICAgICAgICAgICBzZXRTdGF5TmlnaHRzKGNhbGN1bGF0ZU5pZ2h0cyhzdGFydERhdGUsIGVuZERhdGUpKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0YXJ0RGF0ZSwgZW5kRGF0ZSk7XG4gICAgICAgICAgICBzZXRTdGFydERhdGUoc3RhcnREYXRlKTtcbiAgICAgICAgICAgIHNldEVuZERhdGUoZW5kRGF0ZSk7XG4gICAgICAgICAgfX1cbiAgICAgICAgLz5cbiAgICAgICAgeyhkYXRlQ2hvc2VuICYmIChcbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGgyPlByaWNlIHBlciBuaWdodDwvaDI+XG4gICAgICAgICAgICA8cD4ke2hvdXNlLnByaWNlfTwvcD5cbiAgICAgICAgICAgIDxoMj5Ub3RhbCBwcmljZSBmb3IgdGhlIGJvb2tpbmc8L2gyPlxuICAgICAgICAgICAgPHA+JHsoc3RheU5pZ2h0cyAqIGhvdXNlLnByaWNlKS50b0ZpeGVkKDIpfTwvcD5cbiAgICAgICAgICAgIHt1c2VyID8gKFxuICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicmVzZXJ2ZVwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17YXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wb3N0KFwiL2FwaS9ob3VzZXMvcmVzZXJ2ZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgaG91c2VJZDogaG91c2UuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgUmVzZXJ2ZVxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJyZXNlcnZlXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICBzZXRTaG93TG9naW5Nb2RhbCgpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICBMb2cgaW4gdG8gUmVzZXJ2ZVxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkpIHx8IDxwPlBsZWFzZSBzZWxlY3QgZGF0ZXM8L3A+fVxuICAgICAgPC9hc2lkZT5cbiAgICAgIHtob3VzZS5yZXZpZXdzQ291bnQgPyAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmV2aWV3c1wiPlxuICAgICAgICAgIDxoMz57aG91c2UucmV2aWV3c0NvdW50fSBSZXZpZXdzPC9oMz5cblxuICAgICAgICAgIHtob3VzZS5yZXZpZXdzLm1hcCgocmV2aWV3LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgPGRpdiBrZXk9e2luZGV4fT5cbiAgICAgICAgICAgICAgICA8cD57bmV3IERhdGUocmV2aWV3LmNyZWF0ZWRBdCkudG9EYXRlU3RyaW5nKCl9PC9wPlxuICAgICAgICAgICAgICAgIDxwPntyZXZpZXcuY29tbWVudH08L3A+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KX1cbiAgICAgICAgPC9kaXY+XG4gICAgICApIDogKFxuICAgICAgICA8PjwvPlxuICAgICAgKX1cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgICAgZGlzcGxheTogZ3JpZDtcbiAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDYwJSA0MCU7XG4gICAgICAgICAgZ3JpZC1nYXA6IDMwcHg7XG4gICAgICAgIH1cblxuICAgICAgICBhc2lkZSB7XG4gICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcbiAgICAgICAgICBwYWRkaW5nOiAyMHB4O1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9kaXY+XG4gICk7XG4gIHJldHVybiA8TGF5b3V0IGNvbnRlbnQ9e2NvbnRlbnR9PjwvTGF5b3V0Pjtcbn07XG5cbi8vIEhvdXNlLmdldEluaXRpYWxQcm9wcyA9ICh7IHF1ZXJ5IH0pID0+IHtcbi8vICAgLy8gb3VyIHF1ZXJ5IGlzIHRha2VuIGZyb20gdGhlIHVybFxuLy8gICBjb25zdCB7IGlkIH0gPSBxdWVyeTsgLy8gaG91c2VzL3F1ZXJ5UGFyYW1ldGVycy4gSXQgaXMgaW4gdGhlIGZpbGUgbmFtZSBbaWRdLmpzXG4vLyAgIGNvbnNvbGUubG9nKHF1ZXJ5KTtcbi8vICAgcmV0dXJuIHtcbi8vICAgICBob3VzZTogSG91c2VzLmZpbHRlcihob3VzZSA9PiBob3VzZS5pZCA9PT0gaWQpWzBdXG4vLyAgIH07XG4vLyB9O1xuXG5Ib3VzZS5nZXRJbml0aWFsUHJvcHMgPSBhc3luYyAoeyBxdWVyeSB9KSA9PiB7XG4gIGNvbnN0IHsgaWQgfSA9IHF1ZXJ5O1xuXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGBodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2hvdXNlcy8ke2lkfWApO1xuICBjb25zdCBob3VzZSA9IGF3YWl0IHJlcy5qc29uKCk7XG5cbiAgcmV0dXJuIHtcbiAgICBob3VzZVxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgSG91c2U7XG4iXX0= */\\n/*@ sourceURL=/home/emil/development/nextbnb/pages/Houses/[id].js */\"));\n\n  return __jsx(Layout, {\n    content: content\n  });\n}; // House.getInitialProps = ({ query }) => {\n//   // our query is taken from the url\n//   const { id } = query; // houses/queryParameters. It is in the file name [id].js\n//   console.log(query);\n//   return {\n//     house: Houses.filter(house => house.id === id)[0]\n//   };\n// };\n\n\nHouse.getInitialProps = function _callee2(_ref2) {\n  var query, id, res, house;\n  return _regeneratorRuntime.async(function _callee2$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          query = _ref2.query;\n          id = query.id;\n          _context2.next = 4;\n          return _regeneratorRuntime.awrap(fetch(\"http://localhost:3000/api/houses/\".concat(id)));\n\n        case 4:\n          res = _context2.sent;\n          _context2.next = 7;\n          return _regeneratorRuntime.awrap(res.json());\n\n        case 7:\n          house = _context2.sent;\n          return _context2.abrupt(\"return\", {\n            house: house\n          });\n\n        case 9:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n};\n\nexport default House;","map":{"version":3,"sources":["/home/emil/development/nextbnb/pages/Houses/[id].js"],"names":["axios","fetch","Head","Layout","DateRangePicker","calculateNights","useState","useStoreActions","useStoreState","House","house","user","state","setShowLoginModal","actions","modals","dateChosen","setDateChosen","stayNights","setStayNights","startDate","setStartDate","endDate","setEndDate","content","title","picture","type","town","console","log","price","toFixed","post","houseId","id","response","data","status","alert","message","reviewsCount","reviews","map","review","index","Date","createdAt","toDateString","comment","getInitialProps","query","res","json"],"mappings":";;;;AAAA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,MAAP,MAAmB,yBAAnB;AACA,OAAOC,eAAP,MAA4B,kCAA5B;AACA,OAAOC,eAAP,MAA4B,iCAA5B;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,SAASC,eAAT,EAA0BC,aAA1B,QAA+C,YAA/C;;AAEA,IAAMC,KAAK,GAAG,SAARA,KAAQ,OAAe;AAAA,MAAZC,KAAY,QAAZA,KAAY;AAC3B,MAAMC,IAAI,GAAGH,aAAa,CAAC,UAAAI,KAAK;AAAA,WAAIA,KAAK,CAACD,IAAN,CAAWA,IAAf;AAAA,GAAN,CAA1B;AACA,MAAME,iBAAiB,GAAGN,eAAe,CACvC,UAAAO,OAAO;AAAA,WAAIA,OAAO,CAACC,MAAR,CAAeF,iBAAnB;AAAA,GADgC,CAAzC;;AAF2B,kBAKSP,QAAQ,CAAC,KAAD,CALjB;AAAA,MAKpBU,UALoB;AAAA,MAKRC,aALQ;;AAAA,mBAMSX,QAAQ,CAAC,CAAD,CANjB;AAAA,MAMpBY,UANoB;AAAA,MAMRC,aANQ;;AAAA,mBAOOb,QAAQ,EAPf;AAAA,MAOpBc,SAPoB;AAAA,MAOTC,YAPS;;AAAA,mBAQGf,QAAQ,EARX;AAAA,MAQpBgB,OARoB;AAAA,MAQXC,UARW;;AAS3B,MAAMC,OAAO,GACX;AAAA,wCAAe;AAAf,KACE,MAAC,IAAD,QACE;AAAA;AAAA,KAAQd,KAAK,CAACe,KAAd,CADF,CADF,EAIE;AAAA;AAAA,KACE;AAAK,IAAA,GAAG,EAAEf,KAAK,CAACgB,OAAhB;AAAyB,IAAA,KAAK,EAAC,MAA/B;AAAsC,IAAA,GAAG,EAAC,eAA1C;AAAA;AAAA,IADF,EAEE;AAAA;AAAA,KACGhB,KAAK,CAACiB,IADT,SACkBjB,KAAK,CAACkB,IADxB,CAFF,EAKE;AAAA;AAAA,KAAIlB,KAAK,CAACe,KAAV,CALF,CAJF,EAcE;AAAA;AAAA,KACE;AAAA;AAAA,6BADF,EAEE,MAAC,eAAD;AACE,IAAA,YAAY,EAAE,sBAACL,SAAD,EAAYE,OAAZ,EAAwB;AACpCL,MAAAA,aAAa,CAAC,IAAD,CAAb;AACAE,MAAAA,aAAa,CAACd,eAAe,CAACe,SAAD,EAAYE,OAAZ,CAAhB,CAAb;AACAO,MAAAA,OAAO,CAACC,GAAR,CAAYV,SAAZ,EAAuBE,OAAvB;AACAD,MAAAA,YAAY,CAACD,SAAD,CAAZ;AACAG,MAAAA,UAAU,CAACD,OAAD,CAAV;AACD;AAPH,IAFF,EAWIN,UAAU,IACV;AAAA;AAAA,KACE;AAAA;AAAA,uBADF,EAEE;AAAA;AAAA,UAAKN,KAAK,CAACqB,KAAX,CAFF,EAGE;AAAA;AAAA,mCAHF,EAIE;AAAA;AAAA,UAAK,CAACb,UAAU,GAAGR,KAAK,CAACqB,KAApB,EAA2BC,OAA3B,CAAmC,CAAnC,CAAL,CAJF,EAKGrB,IAAI,GACH;AAEE,IAAA,OAAO,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAEkBX,KAAK,CAACiC,IAAN,CAAW,qBAAX,EAAkC;AACvDC,gBAAAA,OAAO,EAAExB,KAAK,CAACyB,EADwC;AAEvDf,gBAAAA,SAAS,EAATA,SAFuD;AAGvDE,gBAAAA,OAAO,EAAPA;AAHuD,eAAlC,CAFlB;;AAAA;AAECc,cAAAA,QAFD;;AAAA,oBAQDA,QAAQ,CAACC,IAAT,CAAcC,MAAd,KAAyB,OARxB;AAAA;AAAA;AAAA;;AASHC,cAAAA,KAAK,CAACH,QAAQ,CAACC,IAAT,CAAcG,OAAf,CAAL;AATG;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAaLX,cAAAA,OAAO,CAACC,GAAR;AAbK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAFX;AAAA,wCACY;AADZ,eADG,GAwBH;AAEE,IAAA,OAAO,EAAE,mBAAM;AACbjB,MAAAA,iBAAiB;AAClB,KAJH;AAAA,wCACY;AADZ,yBA7BJ,CADD,IAwCK;AAAA;AAAA,2BAnDR,CAdF,EAmEGH,KAAK,CAAC+B,YAAN,GACC;AAAA,wCAAe;AAAf,KACE;AAAA;AAAA,KAAK/B,KAAK,CAAC+B,YAAX,aADF,EAGG/B,KAAK,CAACgC,OAAN,CAAcC,GAAd,CAAkB,UAACC,MAAD,EAASC,KAAT,EAAmB;AACpC,WACE;AAAK,MAAA,GAAG,EAAEA,KAAV;AAAA;AAAA,OACE;AAAA;AAAA,OAAI,IAAIC,IAAJ,CAASF,MAAM,CAACG,SAAhB,EAA2BC,YAA3B,EAAJ,CADF,EAEE;AAAA;AAAA,OAAIJ,MAAM,CAACK,OAAX,CAFF,CADF;AAMD,GAPA,CAHH,CADD,GAcC,2BAjFJ;AAAA;AAAA,inMADF;;AAkGA,SAAO,MAAC,MAAD;AAAQ,IAAA,OAAO,EAAEzB;AAAjB,IAAP;AACD,CA5GD,C,CA8GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEAf,KAAK,CAACyC,eAAN,GAAwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAASC,UAAAA,KAAT,SAASA,KAAT;AACdhB,UAAAA,EADc,GACPgB,KADO,CACdhB,EADc;AAAA;AAAA,2CAGJlC,KAAK,4CAAqCkC,EAArC,EAHD;;AAAA;AAGhBiB,UAAAA,GAHgB;AAAA;AAAA,2CAIFA,GAAG,CAACC,IAAJ,EAJE;;AAAA;AAIhB3C,UAAAA,KAJgB;AAAA,4CAMf;AACLA,YAAAA,KAAK,EAALA;AADK,WANe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAxB;;AAWA,eAAeD,KAAf","sourcesContent":["// import Houses from \"../houses.json\";\nimport axios from \"axios\";\nimport fetch from \"isomorphic-unfetch\";\nimport Head from \"next/head\";\nimport Layout from \"../../components/Layout\";\nimport DateRangePicker from \"../../components/DateRangePicker\";\nimport calculateNights from \"../../utils/calculate-nights.js\";\nimport { useState } from \"react\";\nimport { useStoreActions, useStoreState } from \"easy-peasy\";\n\nconst House = ({ house }) => {\n  const user = useStoreState(state => state.user.user);\n  const setShowLoginModal = useStoreActions(\n    actions => actions.modals.setShowLoginModal\n  );\n  const [dateChosen, setDateChosen] = useState(false);\n  const [stayNights, setStayNights] = useState(0);\n  const [startDate, setStartDate] = useState();\n  const [endDate, setEndDate] = useState();\n  const content = (\n    <div className=\"container\">\n      <Head>\n        <title>{house.title}</title>\n      </Head>\n      <article>\n        <img src={house.picture} width=\"100%\" alt=\"House picture\" />\n        <p>\n          {house.type} - {house.town}\n        </p>\n        <p>{house.title}</p>\n        {/* <p>\n          {house.rating} ({house.reviewsCount})\n        </p> // removed*/}\n      </article>\n      <aside>\n        <h2>Add dates for prices.</h2>\n        <DateRangePicker\n          datesChanged={(startDate, endDate) => {\n            setDateChosen(true);\n            setStayNights(calculateNights(startDate, endDate));\n            console.log(startDate, endDate);\n            setStartDate(startDate);\n            setEndDate(endDate);\n          }}\n        />\n        {(dateChosen && (\n          <div>\n            <h2>Price per night</h2>\n            <p>${house.price}</p>\n            <h2>Total price for the booking</h2>\n            <p>${(stayNights * house.price).toFixed(2)}</p>\n            {user ? (\n              <button\n                className=\"reserve\"\n                onClick={async () => {\n                  try {\n                    const response = await axios.post(\"/api/houses/reserve\", {\n                      houseId: house.id,\n                      startDate,\n                      endDate\n                    });\n\n                    if (response.data.status === \"error\") {\n                      alert(response.data.message);\n                      return;\n                    }\n                  } catch (err) {\n                    console.log(err);\n                    return;\n                  }\n                }}\n              >\n                Reserve\n              </button>\n            ) : (\n              <button\n                className=\"reserve\"\n                onClick={() => {\n                  setShowLoginModal();\n                }}\n              >\n                Log in to Reserve\n              </button>\n            )}\n          </div>\n        )) || <p>Please select dates</p>}\n      </aside>\n      {house.reviewsCount ? (\n        <div className=\"reviews\">\n          <h3>{house.reviewsCount} Reviews</h3>\n\n          {house.reviews.map((review, index) => {\n            return (\n              <div key={index}>\n                <p>{new Date(review.createdAt).toDateString()}</p>\n                <p>{review.comment}</p>\n              </div>\n            );\n          })}\n        </div>\n      ) : (\n        <></>\n      )}\n      <style jsx>{`\n        .container {\n          display: grid;\n          grid-template-columns: 60% 40%;\n          grid-gap: 30px;\n        }\n\n        aside {\n          border: 1px solid #ccc;\n          padding: 20px;\n        }\n      `}</style>\n    </div>\n  );\n  return <Layout content={content}></Layout>;\n};\n\n// House.getInitialProps = ({ query }) => {\n//   // our query is taken from the url\n//   const { id } = query; // houses/queryParameters. It is in the file name [id].js\n//   console.log(query);\n//   return {\n//     house: Houses.filter(house => house.id === id)[0]\n//   };\n// };\n\nHouse.getInitialProps = async ({ query }) => {\n  const { id } = query;\n\n  const res = await fetch(`http://localhost:3000/api/houses/${id}`);\n  const house = await res.json();\n\n  return {\n    house\n  };\n};\n\nexport default House;\n"]},"metadata":{},"sourceType":"module"}